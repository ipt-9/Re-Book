<div class="profile-container">
  <app-navbar></app-navbar>

  <section class="profile-header">
    <div class="profile-info">
      <img src="/profile.avif" alt="Profile Picture" class="profile-pic">
      <div>
        <h2>{{ user?.username }} <span class="premium">Premium</span></h2>
        <p class="email">{{ user?.email }}</p>
      </div>
    </div>
    <button class="signout-btn" (click)="logout()">Sign out</button>
  </section>

  <section class="profile-details" *ngIf="user">
    <div class="detail-group">
      <label>Fullname</label>
      <input type="text" [value]="user?.username" disabled>
    </div>
    <div class="detail-group">
      <label>Nickname</label>
      <input type="text" [(ngModel)]="user.nickname">
    </div>
    <div class="detail-group">
      <label>Gender</label>
      <select [(ngModel)]="user.gender">
        <option value="">—</option>
        <option value="Männlich">Männlich</option>
        <option value="Weiblich">Weiblich</option>
        <option value="Divers">Divers</option>
      </select>
    </div>
    <div class="detail-group">
      <label>Country</label>
      <input type="text" [(ngModel)]="user.region">
    </div>
    <div class="detail-group">
      <label>Language</label>
      <input type="text" [(ngModel)]="user.language">
    </div>
    <div class="detail-group">
      <label>School</label>
      <input type="text" [(ngModel)]="user.school">
    </div>

    <button (click)="saveProfile()" class="save-btn">Speichern</button>
  </section>

  <section class="email-section" *ngIf="user">
    <h3>My Email Address</h3>
    <div class="email-info">
      <img src="/email.webp" alt="Email Icon" class="email-icon">
      <div>
        <p class="email-text">{{ user?.email }}</p>
        <p class="email-date">One month ago</p>
      </div>
    </div>
  </section>

  <section class="products" *ngIf="advertisedProducts.length">
    <h3>Advertised products</h3>
    <div class="book-list">
      <a *ngFor="let book of advertisedProducts"
         [routerLink]="['/product']"
         [queryParams]="{ id: book.product_id }"
         class="book-item">
        <img [src]="'https://rebook-bmsd22a.bbzwinf.ch/' + book.image" [alt]="book.title">
        <h4>{{ book.title }}</h4>
        <strong>CHF {{ book.price | number: '1.2-2' }}</strong>
      </a>
    </div>
  </section>

  <section class="products" *ngIf="soldProducts.length">
    <h3>Sold products</h3>
    <div class="book-list">
      <a *ngFor="let book of soldProducts"
         [routerLink]="['/product']"
         [queryParams]="{ id: book.product_id }"
         class="book-item">
        <img [src]="'https://rebook-bmsd22a.bbzwinf.ch/' + book.image" [alt]="book.title">
        <h4>{{ book.title }}</h4>
        <strong>CHF {{ book.price | number: '1.2-2' }}</strong>
      </a>
    </div>
  </section>

  <section class="products" *ngIf="boughtProducts.length">
    <h3>Bought products</h3>
    <div class="book-list">
      <a *ngFor="let book of boughtProducts"
         [routerLink]="['/product']"
         [queryParams]="{ id: book.product_id }"
         class="book-item">
        <img [src]="'https://rebook-bmsd22a.bbzwinf.ch/' + book.image" [alt]="book.title">
        <h4>{{ book.title }}</h4>
        <strong>CHF {{ book.price | number: '1.2-2' }}</strong>
      </a>
    </div>
  </section>


  <app-footer></app-footer>
</div>
